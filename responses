import openai
from PyPDF2 import PdfReader

# Define the path to the PDF file
pdf_path = '/Users/benbonas/Desktop/uclahealth-new-patient-questionnaire.pdf'  # Make sure to update this to the path of your PDF

# Initialize a PDF reader
reader = PdfReader(pdf_path)

# Initialize an empty list to store text from each page
text_from_pdf = []

# Loop through each page in the PDF
for page in reader.pages:
    # Extract text from the current page
    page_text = page.extract_text()
    # Append the extracted text to our list
    text_from_pdf.append(page_text)

# Combine the text from all pages into a single string
combined_text = "\n".join(filter(None, text_from_pdf))  # This will also remove any None values

# Set your OpenAI API key here
api_key = "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"

# Set the API key for the OpenAI client
openai.api_key = api_key


long_text = '/Users/benbonas/treehacks/openai-env/Code/Data'

# List of questions you want to ask based on the questions from the pdf
questions = [
        combined_text
]

# Start constructing the messages for the API call
messages = [{"role": "system", "content": "The following is a detailed context for the conversation: " + long_text}]

# Add each question as a user message
for question in questions:
    messages.append({"role": "user", "content": question})

# Make the API call
response = openai.ChatCompletion.create(
    model="gpt-3.5-turbo",
    messages=messages
)

# Print the answers to the questions
for i, choice in enumerate(response.choices, start=1):
    print(f"Q{i}: {questions[i-1]}")
    print(f"A{i}: {choice.message}\n")
